<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cloudok.authority.mapper.UserMapper">
	
	<resultMap extends="com.cloudok.core.mybatis.BaseMapper.baseMap" type="com.cloudok.authority.po.UserPO" id="userMap">
		
		<result property="userName" column="user_name"/>
		
		<result property="passwdHash" column="passwd_hash"/>
		
		<result property="firstName" column="first_name"/>
		
		<result property="lastName" column="last_name"/>
		
		<result property="email" column="email"/>

		<result property="userType" column="user_type"/>

		<result property="phoneNum" column="phone_num"/>
		
		<result property="country" column="country"/>
		
		<result property="status" column="status"/>
		
		<result property="avatar" column="avatar"/>
		
		<result property="freeze" column="freeze"/>
		
		<result property="sex" column="sex"/>
		
		<result property="birthDate" column="birth_date"/>
		
	</resultMap>

	<sql id="columns">
		t.user_name,t.passwd_hash,t.first_name,t.last_name,t.email,t.user_type,t.phone_num,t.country,t.status,t.avatar,t.freeze 
		,t.sex,t.birth_date,<include refid="com.cloudok.core.mybatis.BaseMapper.baseColumns"/>
	</sql>
	
	<insert id="create" parameterType="com.cloudok.authority.po.UserPO">
		insert into sys_user(user_name,passwd_hash,first_name,last_name,email,user_type,phone_num,country,status,avatar,freeze 
		,sex,birth_date,<include refid="com.cloudok.core.mybatis.BaseMapper.insertBaseColumns"/>)
		values(#{userName},#{passwdHash},#{firstName},#{lastName},#{email},#{userType},#{phoneNum},#{country},#{status},#{avatar},#{freeze},#{sex},#{birthDate},<include refid="com.cloudok.core.mybatis.BaseMapper.insertBaseColumnsValue"/>)
	</insert>
	
	<update id="update" parameterType="com.cloudok.authority.po.UserPO">
		update sys_user set user_name=#{userName},passwd_hash=#{passwdHash},first_name=#{firstName},last_name=#{lastName},email=#{email},user_type=#{userType},phone_num=#{phoneNum},country=#{country},status=#{status},avatar=#{avatar},
              freeze=#{freeze},sex=#{sex},birth_date=#{birthDate},<include refid="com.cloudok.core.mybatis.BaseMapper.updateBaseColumns"/>
		<where>
			<include refid="com.cloudok.core.mybatis.BaseMapper.byId"/>
		</where>
	</update>
	
	<update id="merge" parameterType="com.cloudok.authority.po.UserPO">
		update sys_user set 
			
			<if test="userName != null ">user_name = #{userName},</if>
			
			<if test="passwdHash != null ">passwd_hash = #{passwdHash},</if>
			
			<if test="firstName != null ">first_name = #{firstName},</if>
			
			<if test="lastName != null ">last_name = #{lastName},</if>
			
			<if test="email != null ">email = #{email},</if>

			<if test="userType != null ">user_type = #{userType},</if>

			<if test="phoneNum != null ">phone_num = #{phoneNum},</if>
			
			<if test="country != null ">country = #{country},</if>
			
			<if test="status != null ">status = #{status},</if>
			
			<if test="avatar != null ">avatar = #{avatar},</if>
			
			<if test="freeze != null ">freeze= #{freeze}, </if>
			<if test="sex != null ">sex = #{sex},</if>
			
			<if test="birthDate != null ">birth_date = #{birthDate},</if>
			
			<include refid="com.cloudok.core.mybatis.BaseMapper.updateBaseColumns"/>
		<where>
			<include refid="com.cloudok.core.mybatis.BaseMapper.byId"/>
		</where>
	</update>
	
	<update id="delete" parameterType="list">
		<include refid="com.cloudok.core.mybatis.BaseMapper.delete">
			<property name="tableName" value="sys_user"/>
		</include>	
		<where>
			<include refid="com.cloudok.core.mybatis.BaseMapper.byIds"></include>
		</where>
	</update>
	
	<select id="select"
		parameterType="com.cloudok.core.query.QueryBuilder"
		resultMap="userMap">
		select
		<include refid="columns"></include>
		from sys_user  t
		<where>
			<include refid="com.cloudok.core.mybatis.BaseMapper.condition"/>
		</where>
	</select>

	<select id="count"
		parameterType="com.cloudok.core.query.QueryBuilder"
		resultType="long">
		select
		count(1)
		from sys_user t
		<where>
			<include refid="com.cloudok.core.mybatis.BaseMapper.condition"/>
		</where>
	</select>
</mapper>